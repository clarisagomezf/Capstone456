---
title: "COMP456"
output: html_document
author: "Clarisa Elena Gomez Faria"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Research Questions 

1. What is the correlation between the gender of the protagonist and the revenue generated by movies?

2. In films with female protagonists, what is the disparity in screen time between male and female characters?

3. Are there significant budget differences between movies with male and female protagonists, and do these differences influence production quality, marketing, and overall success at the box office?

4. How does the duration of a movie relate to the presence and significance of female characters within the film?


```{r, include=FALSE}
movies <- readr::read_csv("movies.csv") 
dialogue <- readr::read_csv("dialogue.csv") 
```

## Dataset 1 
```{r}
head(movies)
```

Creator: Hannah Anderson and Matt Daniels, The Pudding

https://melaniewalsh.github.io/Intro-Cultural-Analytics/00-Datasets/00-Datasets.html  

This CSV file is a consolidated and slightly modified version of data shared by Hannah Anderson and Matt Daniels for their Pudding article, “Film Dialogue from 2,000 screenplays, Broken Down by Gender and Age”. The original datasets can be found on GitHub here.

For 2,000 films from 1925 to 2015, the dataset includes information about characters’ names, genders, ages, how many words they spoke in each film, as well as the release year of each film and how much money the film grossed. Anderson and Daniels determined character age and gender (which they code as binary) based on corresponding IMDB information for actors. 

the data has limitations in accuracy as recognized by the authors, since some characters from movies are excluded due to 1.) the process of parsing erroneously excluded the character, 2.) The script did not have the character but the film did, or 3). this is a minor character which was excluded from the study.

I wanted to explore more in depth the budget allocated for movies which dialogue is dominated by men vs women. However I am having trouble plotting this variables. 


```{r}
library(GGally)

movies <- na.omit(movies) # Remove rows with missing values

ggpairs(movies, columns = c("binary", "budget_2013$", "domgross_2013$", "intgross_2013$"), aes(fill = binary))

# Extract density plot
ggplot(data = movies, aes(x = 'budget_2013$', fill = binary)) +
  geom_density(alpha = 0.5) +
  labs(title = "Density Plot of Budget vs. Binary")

# Extract box plot
ggplot(data = movies, aes(x = binary, y = 'budget_2013$')) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Box Plot of Budget by Binary")

```

## Dataset 2
```{r}
head(dialogue)
```


Author: Carolee Mitchell via https://data.world/carolee

https://www.kaggle.com/datasets/thedevastator/box-office-performance-of-movies-with-female-lea?resource=download

This dataset explores the impact of gender on box office success. It looks at data from films released between 1970 and 2013, including their budgets, domestic and international gross earnings, and their pass/fail status on the Bechdel Test - a benchmark measuring gender biases in movies.

I believe I could join these two data sets by the title of the movies, as they both have a title column. It would be interesting to see how many movies exist in both data sets and would work to create a new joint dataset. 


```{r}
library(dplyr)
library(ggplot2)

# Group the filtered data by year and gender, and calculate the average proportion of words spoken
average_proportion <- dialogue %>%
  filter(gender %in% c("man", "woman")) %>% 
  filter(release_year > 1955) %>% 
  group_by(release_year, gender) %>%
  summarize(avg_proportion = mean(proportion_of_dialogue))

# Create a line plot
ggplot(average_proportion, aes(x = release_year, y = avg_proportion, color = gender)) +
  geom_line() +
  labs(
    title = "Proportion of Words by Gender Over Time",
    x = "Release Year",
    y = "Average Proportion of Words",
    color = "Gender"
  ) +
  scale_color_manual(values = c("man" = "orange", "woman" = "darkgreen")) + # Set custom colors
  theme_minimal()

```

